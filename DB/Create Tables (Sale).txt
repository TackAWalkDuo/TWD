CREATE SCHEMA `twd_shop`;

CREATE TABLE `twd_shop`.`sale_product`
(
    `index`          INT UNSIGNED NOT NULL AUTO_INCREMENT,
    `article_index`  INT UNSIGNED NOT NULL,
    `quantity`       INT UNSIGNED NOT NULL,           # -- 수량
    `cost`           INT UNSIGNED NOT NULL,           # -- 원가
    `discount`       INT UNSIGNED NOT NULL DEFAULT 0, # --할인가.
    `price`          INT UNSIGNED NOT NULL,           # -- 판매가
    `profit`         INT UNSIGNED NOT NULL,           #  -- 이익
    `category_index` INT UNSIGNED NOT NULL,           #   -- 상품 분류 1.사료 2.간식 3.옷 4.기타
    CONSTRAINT PRIMARY KEY (`index`),
    CONSTRAINT FOREIGN KEY (`article_index`) REFERENCES `twd_bbs`.`articles` (`index`)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (`category_index`) REFERENCES `twd_bbs`.`articles` (`index`)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);

CREATE TABLE `twd_shop`.`product_categories`
(
    `index` INT UNSIGNED NOT NULL AUTO_INCREMENT,
    `text`  VARCHAR(10)  NOT NULL,
    CONSTRAINT PRIMARY KEY (`index`)
);

CREATE TABLE `twd_shop`.`shopping_cart`
(
    `user_email`      VARCHAR(50)  NOT NULL,
    `product_index`   INT UNSIGNED NOT NULL,
    `sale_price`      INT UNSIGNED NOT NULL,
    `quantity`        INT UNSIGNED NOT NULL,
    `registration_on` DATE         NOT NULL DEFAULT NOW(),
    CONSTRAINT PRIMARY KEY (`user_email`),
    CONSTRAINT FOREIGN KEY (`user_email`) REFERENCES `twd_member`.`user` (`email`)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (`product_index`) REFERENCES `twd_shop`.`sale_product` (`article_index`)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);

CREATE TABLE `twd_shop`.`payment`
(
    `index`           INT UNSIGNED NOT NULL AUTO_INCREMENT,
    `user_email`      VARCHAR(50)  NOT NULL,
    `product_index`   INT UNSIGNED NOT NULL,
    `sale_price`      INT UNSIGNED NOT NULL,
    `quantity`        INT UNSIGNED NOT NULL,
    `delivery fee`    INT UNSIGNED NOT NULL DEFAULT 3000,
    `registration_on` DATE         NOT NULL DEFAULT NOW(),
    `delivery_status` INT UNSIGNED NOT NULL DEFAULT 0,
    CONSTRAINT PRIMARY KEY (`index`)
)